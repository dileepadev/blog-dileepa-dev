---
// Welcome component for the blog home page
const modules = import.meta.glob("../content/posts/**/*.mdx", { eager: true });

const posts = Object.entries(modules)
  .map(([path, mod]) => {
    const m = mod as any;
    const slug =
      path
        .split("/")
        .pop()
        ?.replace(/\.mdx$/, "") ?? "";
    return {
      slug,
      ...(m.frontmatter || {}),
    };
  })
  .sort(
    (a, b) => new Date(b.pubDate).getTime() - new Date(a.pubDate).getTime(),
  );

const latestPost = posts[0];

function formatDate(date: string) {
  return new Date(date).toLocaleDateString("en-US", {
    year: "numeric",
    month: "long",
    day: "numeric",
  });
}
---

<div class="relative w-full py-20 px-4 overflow-hidden">
  <!-- Background Gradient Blob -->
  <div
    class="absolute top-0 left-1/2 -translate-x-1/2 w-200 h-125 bg-accent-blue/5 rounded-full blur-3xl -z-10 opacity-50 dark:opacity-20 pointer-events-none"
  >
  </div>

  <div class="max-w-4xl mx-auto text-center relative z-10">
    <!-- Main Heading -->
    <h1
      class="text-5xl md:text-7xl font-extrabold text-transparent bg-clip-text bg-linear-to-r from-text-primary via-accent-blue to-accent-purple mb-6 animate-fade-in tracking-tight"
    >
      Welcome to my dev blog
    </h1>

    <!-- Description -->
    <p
      class="text-lg md:text-xl text-text-secondary mb-10 max-w-2xl mx-auto leading-relaxed"
    >
      Dive into insightful tutorials, cutting-edge projects, and
      thought-provoking discussions about the technologies shaping our future.
    </p>

    <!-- Topic Chips -->
    <div class="flex flex-wrap justify-center gap-3 mb-12">
      {
        [
          "Artificial Intelligence",
          "Cloud Computing",
          "Software Development",
        ].map((topic) => (
          <span class="px-5 py-2 rounded-full bg-bg-elevated border border-border-light text-text-secondary font-medium hover:text-accent-blue hover:border-accent-blue/30 hover:shadow-md transition-all duration-300 cursor-default">
            {topic}
          </span>
        ))
      }
    </div>

    <!-- CTA Buttons -->
    <div class="flex justify-center gap-4">
      <a
        href="/blog"
        class="group relative inline-flex items-center gap-2 px-8 py-3 bg-text-primary text-bg-primary rounded-full font-bold text-lg hover:bg-accent-blue transition-colors duration-300 shadow-lg hover:shadow-accent-blue/25"
      >
        Read All Posts
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-5 w-5 transition-transform duration-300 group-hover:translate-x-1"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
        </svg>
      </a>

      <a
        href="/blog#search"
        class="inline-flex items-center gap-2 px-6 py-3 border border-border-light rounded-full font-semibold text-text-primary bg-bg-default hover:bg-bg-elevated transition-colors duration-200"
      >
        Search Posts
        <svg
          xmlns="http://www.w3.org/2000/svg"
          class="h-4 w-4"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M21 21l-4.35-4.35M10.5 18a7.5 7.5 0 1 1 0-15 7.5 7.5 0 0 1 0 15z"
          ></path>
        </svg>
      </a>
    </div>
  </div>
</div>

<!-- Latest Blog Section -->
<div class="w-full py-16 px-4">
  <div class="max-w-4xl mx-auto">
    <h2 class="text-3xl font-bold text-text-primary mb-8 text-center">
      Latest Blog Post
    </h2>

    {
      latestPost ? (
        <a
          href={`/blog/${latestPost.slug}`}
          class="block p-6 bg-bg-elevated border border-border-light rounded-xl hover:shadow-lg hover:border-accent-blue/30 hover:scale-[1.01] transition-all duration-300 group"
        >
          {latestPost.banner && (
            <img
              src={latestPost.banner}
              alt={latestPost.bannerAlt || latestPost.title}
              class="w-full h-44 md:h-56 object-cover rounded-md mb-4"
              loading="lazy"
            />
          )}

          {latestPost.pubDate && (
            <p class="text-sm text-text-muted mb-2 font-medium">
              {formatDate(latestPost.pubDate)}
            </p>
          )}

          <h3 class="text-2xl font-semibold text-text-primary group-hover:text-accent-blue transition-colors">
            {latestPost.title}
          </h3>

          <p class="mt-3 text-text-secondary line-clamp-3">
            {latestPost.description}
          </p>

          {latestPost.tags && (
            <div class="mt-3 flex gap-2 flex-wrap">
              {latestPost.tags.map((tag: string) => (
                <span class="capitalize rounded-md bg-bg-secondary border border-border-light text-text-secondary px-2.5 py-0.5 text-sm font-medium">
                  {tag}
                </span>
              ))}
            </div>
          )}
        </a>
      ) : (
        <div class="text-center">
          <p class="text-lg text-text-secondary mb-4">Coming soon...</p>
          <p class="text-text-tertiary mb-6">
            I'm working on some exciting articles. Stay tuned for the latest
            insights on AI, cloud computing, and software development!
          </p>
        </div>
      )
    }
  </div>
</div>
